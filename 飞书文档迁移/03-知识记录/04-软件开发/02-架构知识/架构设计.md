---
created: '2024-07-25 14:15:39'
feishu_url: https://wk5tnvpfe7.feishu.cn/docx/NPUrdaU3qozwgPxuaUxcFc2dnLd
modified: '2024-07-25 14:36:13'
source: feishu
title: 架构设计
---

架构设计
从0到1完成一个架构设计
项目需求
本项目为一个资源管理平台，支持灵活配置资源展示形式，支持制作员进行资源的制作，资源审核员进行资源的审核，资源管理员进行资源的管理以及对外发布。在制作环节为了满足制作的需求，我们需要可以通过大模型进行资源的生产，需要借助合成进行语音的合成。同时为了满足评测需要，我们需要借助评测引擎，去评测资源的正确性。在审核环境我们需要能够进行内容合规的审核。在资源对外发布过程，需要能将资源给到外部系统。

以上为一个项目的项目的需求，在我们正式进行架构设计前，我们需要知道架构设计具体要做哪些。因此我们先看一下概念。
架构的定义及构成
软件架构是软件系统的总体设计，是一个项目的起点，是有关软件整体结构与组件的抽象描述，用于指导软件系统各个方面的设计。因此整个一个完整的架构设计包括：业务架构、产品架构、技术架构共计3项组成。因此有了下图
VZEObmBWGoFVdRx8kb5cFowhnOc.png

因此我们需要完成一个完整的架构设计，其实也就是完成上面4项即可。所以我们需要一一进行拆解。
业务架构
业务架构就是在业务需求初期，将模糊的需求转换成清晰的问题，梳理出一个完整的业务流程。因此需要进行两项动作，那就是业务分析和需求分析。因此我们上面的那个图又扩展了。

O2u7bYIHOoWpLrxc3pXcc3mInDf.png

因此我们就先跟进上面的需求进行业务分析
业务分析
业务分析师对一个业务领域进行分析建模的过程，是项目的起点，因此我们需要先梳理我们这个项目所做的系统需要解决的业务问题。将梳理的业务问题形成一个完整的业务流程，从而输出领域模型、业务模型。因此我们又得到了以下一个思维导图。
BYm5bpdcoo21iMx20lucEwB8njd.png

那么如何去输出我们所需要的两个模型呢？这个就需要产品经理以及系统分析师通过所有的业务知识，类似产品以及通过与客户沟通的结果去思考和分析。那么具体怎么做呢？
业务流程
列出问题绘制业务流程
将核心需求列出来，列出当前需要解决的需求以及未来可能要解决的需求。按照业务的流程进行绘制。因此我们可以将项目的需求绘制成以下的业务流程。
S780byRCfo9WZMxwzAlcwWB6nfd.jpg

领域模型
从业务流程生成领域模型
在生成领域模型前我们需要了解下领域模型的定义，领域模型（Domain Model）是对特定领域内概念和实体的一种抽象表示，它描述了领域内的实体、属性、关系等概念，以及这些概念之间的相互关系。因此领域模型主要元素三个：
实体：现实世界中存在的对象，例如：人，物品，事件。每个实体都有自己的属性和行为
属性：属性是实体的特征，用来描述实体的状态和特征。例如人的姓名，物品的价格
关系：关系是用来表述不同实体间的联系。例如：负责关系，买卖关系。关系通过箭头表示，箭头的放心表示关系的方向。
到这其实我想很多人应该明白了，其实领域模型就是一个ER图。因此我们基于上面的业务流程来构建我们自己的领域模型，当前采用四色原型法 （某个人（Party）的角色在某个地点（Place）的角色（PlaceRole）用某个东西（Thing）的角色（ThingRole）做了某件事情（MomentInterval）） 来进行构建，详细构建方式可以在研发工程师进阶之路之领域模型因此我们就有了一个基于业务流程图提取出的一个领域模型。
EKxHbZhX1ogyOnx4J6XcARvgnHQ.jpg

模板制作员在模板制作阶段创建了多个模板，资源制作员在资源制作阶段选择模板生成多个资源，资源审核员在资源审核阶段对生成的资源进行审核生成多个资源审核结果。资源管理员在资源管理阶段进行资源的搜索管理，业务管理员在资源授权阶段进行授权生成了多项授权记录，每一个授权记录中包含一个授权包。此解读与4色原型法构建领域模型是一一对应的。
ER图
从领域模型中提取ER图
上面有了领域模型，那么我们接下来就需要有业务模型，业务模型的目的其实是为了搞清楚业务领域的概念以及业务的运转过程。那么我们就要从需求以及领域模型中去分析以下三点：
1、业务有哪些人或者事构成
2、系统可以为业务的人或者事提供什么服务
3、为业务的人提供的服务的运转的过程
上述三件事用转换成专业术语也就是三点：业务模型、业务用例、业务流程。那么我们也就得出了下面一个思维导图
INnLb6lnLo0Gi2xczhNcGLoZn9Z.png

但是如何提取这三点呢？下面来一一介绍
业务对象

业务对象的定义是：指的是在软件系统中用来模拟现实世界中商业实体的对象。从这句话中我们可以得出一个结论。业务对象不仅仅是是人，它可以是人也可以是其他系统，因此我们又将业务对象分为以下三种：
1、业务执行者：使用服务的人
2、业务工人：服务的内部支撑人员（不然也不会叫工人不是）
3、业务实体：服务的内部系统
因此我们又扩充了上面的思维导图，那就是
RP0pbLLsyoPkMhxtZAVcciPOnqd.png

那么我们从上述的领域模型以及需求衍生不难看出我们平台的业务对象有哪些：
1、业务执行者：模板制作员，资源制作员，系统审核员，资源管理员，业务管理员。
2、业务工人：平台管理员（任何平台都需要一个平台管理员，用来做一个支撑性的工作不是吗，这一项就不完全通过领域模型可以提取了。）
3、业务实体：模板制作系统，资源制作系统，授权系统，资源管理系统，以及从需求分析得到的：合成服务，评测服务，大模型服务，授权给的第三方系统。
那么我们就有了以下的业务对象图
ZdGybZUqvoEG6MxLSZZcKvt7nde.jpg

业务用例

业务用例的定义是：业务用例用来表达参与者（通常是业务系统的用户或客户）如何与系统互动，以实现具体的业务目标。
因此我们可以得出一个结论，一个业务用例需要包含三个必要元素：
1、业务用例名称：简洁明了的描述业务用例的主题或行为
2、参与者：直接参与业务用例的人员、组织、系统或角色
3、参与者的行为：参与者在用例中做了什么。
因此上述的思维导图又扩充了
ZjVSbJp4YoycRlxrf4Nc5sXrnbc.png

那么我们怎么去实现用例呢？这个时候我们再回到我们开始说的我们需要对领域模型进行提炼，从而形成我们的业务模型。因为其中绿色的 Part-Place-Thing Archetype（参与方-地点-物品原型），可以用来表示 ER 图中的实体模型。红色的 Moment-Interval Archetype（时标性原型），可以用来表示 ER 图中的关系。于是有了下面的ER图
C4XmblTBEoLRAZxzRAzcWnGInQf.jpg

同时我们前面也有业务流程了，那么我们就需要对业务流程进行分析，从而识别出里面的业务功能，将业务流程和业务功能都列出来，形成一个业务功能图。
XFebb7Ho8oftvxxJxHxclQqXnYs.jpg

有了ER图，以及业务功能图。那么我们就可以来提炼其中的用例了，因为业务用例的定义明确说出了，业务用例表明参与者与系统的互动以及实现的业务目标。所以我们可以得到以下几个用例
QqLhbE5OJoBI4SxpcaUczOBinAf.jpg

业务流程

业务流程的定义是：对一个组织内部连续完成的系列活动或者任务的详细描述。因此我们可以理解为业务流程就是什么人在这个系统中做了什么东西得到了什么东西，我们前面已经明确了业务流程是啥样的了，但是我们需要通过另一种展示形式，要能让使用者根据图看到资源的流转的状态以及顺序，因此我们需要将图改造成一个时序图。因此我们有了以下一个业务流程的时序图
FBV8bghnBoDeCqxarZacLhwun4g.jpg

至此我们业务架构中的业务分析需要做的已经做完了，下面我们就开始做业务架构中的另一个模块-需求分析。

需求分析
上面我们说过了业务分析，其实其中也设计到需求分析，现在我们单独来看需求分析，我们拿到一个需求，我们需要进行单独的分析，这个时候其实不涉及任何的平台，平台这个时候对于此项来说就是一个黑盒。所以我们在这个阶段只需要输出三个产物，分别是系统上下文
1、系统上下文
2、功能性需求
3、非功能性需求
因此我们上面的思维导图又有了一个新的更新
EcqfbPBg9owl47xckdYcj5Btnbb.png

系统上下文

我们先来看看系统上下文的定义：
系统上下文，是一个系统的周边关系，一个系统有多个用户以及若干个需要对接的其他系统，把这些元素汇总起来就构成了系统上下文。
从这句话我们其实可以看出，我们要实现一个上下文，只需要将系统当做一个黑盒，将用户以及其他系统管理起来，就完成了系统的上下文。下面就是我们这个需求的系统上下文
VuTBbY8aaogwcSxvb7XcqZwPnjh.jpg

从图中可以看出我们这个平台就是一个黑盒，所有的用户在左边，右边为关联的系统

功能性需求

依旧先看下功能性需求的定义：系统对各类用户以及外部系统提供的功能的总和。我们可以理解为整个系统的功能（内外部）就是这个系统的功能的性需求。因此功能性需求的主体是系统用例，所以我们只需要将前面的业务流程中的流程给拆解出来就形成了一个个的系统用例。注意这个时候系统依旧是一个大的黑盒，系统内部的功能不能作为一个系统用例来进行说明。那么如何实现这些用例呢？我们再回到定义，我们从定义上可以将功能性需求分为两类：系统内部和外部系统。那么用例也应该是两类，内部用例和外部用例。那么我们的思维导图又增加了一点了
BJc3beX5xoV6rrxM8cKcOuyjnyd.png

内部用例，我们其实在上面的业务用例已经写过了。那么我们其实也仅仅只需要再业务用例的基础上补充下外部系统提供的功能即可。所以我们有了我们功能性需求的用例汇总.

非功能性需求
一个系统除了有功能性的需求外，还有非功能性的。如果没有这些非功能性的需求，系统会很难用或者不可用，因此我们需要再需求分析阶段，就将非功能性需求一并拉入范围内，所以非功能性需求主要包含以下几个方面：可用性，性能，安全性，可维护性，可拓展性，可伸缩性，经济性。
由于非功能性的需求都是根据各个系统来定，所以每一个的定义和说明，本章就不过多说明，大家可以移步到刘刚老师的架构设计方法-架构设计。
至此，我们业务架构中的所需要的分析都已结束，下面我们看产品架构
D81HbOO9Eotxx8xxLlmcSKMjn6d.jpg


产品架构

产品架构，顾名思义。整个产品的架构图，但是它来自于业务流程。但是两者的侧重点不同，产品架构更注重产品功能的枚举，功能模块间的分界。因此我们只至需要将上面的业务流程功能图进行提炼，将流程图转换成节点分层，每层存放节点的功能点即可，所以我们就得到了初版的产品架构图。
Cmsbb4iHxoighfx5duxctpjonJb.jpg

再此基础上，我们把同一组的产品功能模板放在同一个层级，这样我们就得到了一个基础的产品架构层。
Hhs2bc0Y3oHNLCxSKdacgpIMndd.jpg

现在我们就需要再回过头看一个产品架构的构成，一个产品架构图至少有以下三层
1、用户层：用户在何种场景操作系统
2、功能模块层：系统通过哪些功能来实现产品的核心功能，和外部哪些平台有信息交互
3、数据层：数据从哪来，数据又到哪去
因此我们的思维导图又增加了一点
HOyqbInCxolgDlxiZt8cw0BLnjg.png

那么我们根据这个要求再反观我们的上面的基础产品架构图，我们可以得出我们需要再基础产品架构图中增加数据层，外部系统交互，以及信息流转信息即可。所以我们有了下图
ScDBbScubokOZJxqEUXcORMJncb.jpg

至此我们的产品架构也完成了，下面我们就要看我们的技术架构了

技术架构

在我们前面进行系统需求分析的时候，我们一直把系统当做的是一个黑盒，仅仅描述了系统对外提供的各种功能性以及非功能性的能力。但是到了技术架构就不行了。因为技术架构就是要研究系统内部是如何实现的。所以我们一般从是否涉及技术性问题来将技术架构分为两个阶段：逻辑架构设计和物理架构设计。那么我们的思维导图又有了一个更新
Wdjlb53AeoLWbMxiRrxc0mBFnhh.png

老规矩，先看定义,逻辑架构是一个系统或软件架构的抽象表示，它定义了系统的功能和它们之间的关系，无需涉及具体的实现细节。从定义我们可以看出。逻辑架构关注于系统的功能需求，而不是系统的物理实现。逻辑架构通常包括一系列逻辑组件（或称为模块、服务、层等），这些组件表达了系统完成其需求所需的主要功能。同时有一系列的关系来进行各个逻辑组件之间的信息传递。所以我们可以按照关系的动、静将逻辑架构设计给分成两块：

逻辑架构概览图：表达组件分层，用户与组件，组件与组件间的静态关系
逻辑组件交互序列图：表达用户与组件，组件与组件间的动态关系

所以我们的思维图又更新了以下

RawJbzEDloobPsxl6i7cJvFlnAe.png

逻辑架构概览图
逻辑架构概览图，是表达组件分层，用户与组件，组件与组件间的静态关系。这是不是很熟悉？我们往上看看产品架构。是不是已经完成了分层了，是不是已经完成了组件间的静态关系了？那么我们只需要再增加用户与组件间的关系即可。所以我们有了逻辑架构预览图了

CpXXbrA8VoNQ4pxjCK4cZ1V1nXf.jpg


这样我们实现了逻辑架构图，所以我们其实实现上只是将产品架构每一个功能块替换成一个个的组件，然后增加外部系统以及用户即可。所以我们可以用一句话来概括逻辑架构，那就是什么用户在什么地方使用系统的什么组件，这个组件又和系统的其他什么组件进行交互，产生了什么数据，存储在什么地方以及系统与外部系统进行了什么交互

逻辑组件交互序列图
上面我们把逻辑架构图给完成了，下面我们就需要通过逻辑组件交互序列图来动态的表明用户与组件，组件与组件间的动态关系了。那么怎么画这个逻辑组件交互序列图呢，我们前面已经完成了业务流程的序列图，那么我们其实同样的将其中的处理变成一个个组件即可。所以有了下图
AVYGbZFVcoPm2hxitJQc4eYmnNg.jpg

什么用户在什么地方使用系统的什么组件，这个组件又和系统的其他什么组件进行交互，产生了什么数据，存储在什么地方以及系统与外部系统进行了什么交互。

（这里就有了一个坑了，那就是跟业务流程的序列图一样，所以从业务分析来看，我们应该再业务流程的序列图中间系统内部的序列给去掉，这点还不知道是否对，这个就需要看看有没有大佬指点了）

物理架构
老规矩，先看定义，物理架构通常指的是一个系统的具体物理组件及其相互之间的布局和连接方式。所以我们就需要将逻辑架构中的组件转换成技术上的物理组件，然后讨论下这些组件用什么技术去实现，组件间通过什么协议来交流。因此我们在物理架构中需要有以下几个产物
1、物理架构概览图
2、组件部署图
3、服务器部署图
4、开发组件清单
5、部署组件清单
5、技术选型清单
7、技术决策表
所以我们的思维导图就增加了新的元素，如图：
D8hjbNwPsoCQs6xJy8acXiN1nKc.png

下面我们一一来看具体怎么实现
物理架构概览图
物理架构概览图其实在我们前面所实现的逻辑架构概览图的基础上，将组件转换成技术性的组件。那么就有了下图
OZRJbNtGGoK5ugxNLPGcXdgZnEa.jpg

有了物理架构概览图，后面的几个图以及清单由于不同的业务会有不同的方案，且刘刚老师的架构设计方法-架构设计都有清楚的说明，大家移步去看下就行了。

总结
至此我们完成了一个系统的从0 到1的架构设计，最后也得到了最终的一个思维导图
TdisbI2ySo8Gl5xZHBwcSiurnJf.png

结语
写完了，我可以回去自己的前端中继续遨游了。这次的设计让我其实从一个舒适区走进一个未知区，很不一样的感觉。所以研发的路怎么走呢？从现在的我来看无非两条要么深度，要么广度，深可以前端继续钻，广可以涉猎更多的技术。亦或者走出第三条路，广而深。但是不管怎么选择，希望自己以及大家都可以坚持下去。因为Coding is beautiful. 最后把我很喜欢的一句电影台词(知道是哪个电影吗？嘿嘿)分享给大家。
